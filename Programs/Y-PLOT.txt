1 GO TO 100
4 GO TO 250
100 INIT 
105 PRINT @32,17:4
110 DIM T(23),X(2),Y(100),U$(20),R$(1)
120 R=0
130 X=0
140 T=0
150 T(2)=1
160 T(3)=1
170 T(4)=30
180 T(5)=80
190 T(8)=1
200 T(9)=1
210 T(14)=10
220 T(15)=80
230 T(18)=1
240 T(19)=1
250 PRINT "L_	Y-ONLY DATA PLOT____ 1  ENTER Y DATA__ 2  DISPLAY DATA"
260 PRINT " 3  LIST DATA__ 4  LIST PARAMETERS__ 5  SET X PARAMETERS"
270 PRINT " 6  SET X SCREEN POSITION__ 7  SET Y SCREEN POSITION"
280 PRINT " 8  SET X DATA RANGE__ 9  SET Y DATA RANGE"
290 PRINT "10  SELECT PLOT MODE__11  SELECT SYMBOL__12  INSERT DATA"
300 PRINT "13  DELETE DATA__14  CHANGE DATA__15  STORE DATA__16  STOP"
310 PRINT "____ENTER MENU ITEM NUMBER OR M FOR NEW MENU G_";
320 GOSUB 370
330 U1=VAL(U$)
340 IF U1<=17 THEN 410
350 PRINT "ERRORG_"
360 GO TO 310
370 INPUT U$
380 IF U$="M" THEN 250
390 U$=U$&",0"
400 RETURN 
410 IF U1<1 THEN 350
420 IF U1>12 THEN 460
430 IF U1>6 THEN 450
440 GO TO U1 OF 990,2160,2070,1780,620,760
450 GO TO U1-6 OF 740,750,730,920,970,1390
460 GO TO U1-12 OF 1390,1390,500,480
470 GO TO 310
480 FIND 1
490 OLD 
500 PRINT "INSERT DATA TAPE AND ENTER FILE NUMBER";
510 GOSUB 370
520 U1=VAL(U$)
530 FIND U1
540 WRITE T(1)
550 FOR U1=1 TO T(1)
560 WRITE Y(U1)
570 NEXT U1
580 CLOSE 
590 PRINT "DATA STOREDG___INSERT SYSTEM TAPE AND PRESS RETURN"
600 GOSUB 370
610 GO TO 310
620 GOSUB 640
630 GO TO 310
640 PRINT "__ENTER BEGINNING X ";
650 GOSUB 370
660 X(1)=VAL(U$)
670 PRINT "ENTER X INCREMENT ";
680 GOSUB 370
690 X(2)=VAL(U$)
700 T(6)=X(1)
710 T(7)=X(2)*T(1)
720 RETURN 
730 R=2
740 R=R+8
750 R=R+2
760 R=R+4
770 U$=CHR(88+(R>11))
780 PRINT "PLEASE ENTER ";U$;
790 U$="SCREEN"
800 IF R=4 OR R=14 THEN 820
810 U$="DATA"
820 PRINT " ";U$
830 PRINT "	MINIMUM ";
840 GOSUB 370
850 T(R)=VAL(U$)
860 PRINT "	MAXIMUM ";
870 GOSUB 370
880 T(R+1)=VAL(U$)
890 T(R+1)=T(R+1)-T(R)
900 R=0
910 GO TO 310
920 PRINT "__1  LINE PLOT MODE__2  POINT PLOT MODE__"
930 PRINT "__SELECT NUMBER AND PRESS RETURN ";
940 GOSUB 370
950 T(U1-8)=VAL(U$)
960 GO TO 310
970 PRINT "__1 __2 TRIANGLE__3 PLUS SIGN__4 SQUARE__5 DIAMOND"
980 GO TO 930
990 T(6)=0
1000 T(7)=0
1010 T(16)=0
1020 T(17)=0
1030 IF T(1)<=0 THEN 1080
1040 PRINT "__DO YOU WISH TO ADD TO PREVIOUS DATA";
1050 GOSUB 1200
1060 GO TO U0 OF 1070,1110
1070 LET T(1)=0
1080 PRINT "DO YOU WISH TO USE THE KEYBOARD";
1090 GOSUB 1200
1100 GO TO U0 OF 1250,1110
1110 PRINT "L_ENTER M TO DISCONTINUE DATA ENTRY__"
1120 PRINT T(1)+1;".....";
1130 GOSUB 370
1140 IF LEN(U$)<1 THEN 1130
1150 Y(T(1)+1)=VAL(U$)
1160 T(1)=T(1)+1
1170 IF T(1)<100 THEN 1120
1180 PRINT "MAXIMUM NUMBER OF VALUES IS 100G_"
1190 GO TO 310
1200 PRINT "(Y or N)";
1210 INPUT R$
1220 U0=POS("NY",R$,1)
1230 IF U0=0 THEN 1210
1240 RETURN 
1250 PRINT "TAPE PROCESSING";
1260 GOSUB 1200
1270 GO TO U0 OF 1080,1280
1280 PRINT "INSERT DATA TAPE AND ENTER TAPE FILE # ";
1290 GOSUB 370
1300 U1=VAL(U$)
1310 FIND U1
1320 READ @33:T(1)
1330 FOR U1=1 TO T(1)
1340 READ @33:Y(U1)
1350 NEXT U1
1360 PRINT "INSERT SYSTEM TAPE AND PRESS RETURN";
1370 GOSUB 370
1380 GO TO 310
1390 U$=SEG("PRECEDEDDELETED CHANGED ",(U1-12)*8+1,8)
1400 T(6)=0
1410 T(7)=0
1420 T(16)=0
1430 T(17)=0
1440 PRINT "____ENTER ITEM NUMBER TO BE ";U$;"G_";
1450 GOSUB 370
1460 U2=VAL(U$)
1470 IF U2=>1 AND U2<=T(1) THEN 1500
1480 PRINT "OUT OF RANGEG_G_"
1490 GO TO 310
1500 GO TO U1-11 OF 1505,1630,1710
1505 IF T(1)=>100 THEN 1480
1510 PRINT "ENTER NEW VALUE ";
1520 GOSUB 370
1530 U3=VAL(U$)
1540 FOR U1=U2 TO T(1)
1550 U4=Y(U1)
1560 Y(U1)=U3
1570 U3=U4
1580 NEXT U1
1590 T(1)=T(1)+1
1600 Y(T(1))=U3
1610 U1=12
1620 GO TO 1390
1630 PRINT "VALUE DELETED",Y(U2)
1640 IF U2=T(1) THEN 1680
1650 FOR U1=U2 TO T(1)-1
1660 Y(U1)=Y(U1+1)
1670 NEXT U1
1680 T(1)=T(1)-1
1690 U1=13
1700 GO TO 1390
1710 PRINT "CURRENT VALUE OF ITEM ";U2;" IS ";Y(U2)
1720 PRINT "CHANGE TO ";
1730 GOSUB 370
1740 U3=VAL(U$)
1750 Y(U2)=U3
1760 U1=14
1770 GO TO 1390
1780 PRINT "L_ PARAMETER LIST__"
1790 PRINT "NUMBER OF POINTS",T(1)
1800 PRINT "LINE CODE",T(2)
1810 PRINT "SYMBOL CODE",T(3)
1820 U9=4
1830 U8=14
1840 U2=0
1850 PRINT 
1860 FOR U5=1 TO 20
1870 PRINT " ";
1880 NEXT U5
1890 PRINT "----X----         ----Y----"
1900 U$="SCREEN MINIMUM"
1910 GOSUB 1990
1920 U$="SCREEN RANGE"
1930 GOSUB 1990
1940 U$="DATA MINIMUM"
1950 GOSUB 1990
1960 U$="DATA RANGE"
1970 GOSUB 1990
1980 GO TO 310
1990 U5=20-LEN(U$)
2000 PRINT U$;
2010 FOR U1=1 TO U5
2020 PRINT " ";
2030 NEXT U1
2040 PRINT T(U9+U2),T(U8+U2)
2050 U2=U2+1
2060 RETURN 
2070 PRINT "L_  DATA LIST____NUMBER             VALUE"
2080 IF T(1)=0 THEN 2140
2090 FOR U1=1 TO T(1)
2100 PRINT U1,Y(U1)
2110 NEXT U1
2120 PRINT "END OF LIST"
2130 GO TO 310
2140 PRINT "NO DATA POINTS"
2150 GO TO 310
2160 IF X(2)>0 THEN 2180
2170 GOSUB 640
2180 IF T(17)>0 THEN 2200
2190 GOSUB 3030
2200 U9=4
2210 IF T(7)>0 THEN 2240
2220 T(6)=X(1)
2230 T(7)=X(2)*T(1)
2240 GOSUB 3120
2250 U9=14
2260 GOSUB 3120
2270 U8=4
2280 PAGE 
2290 VIEWPORT T(4),T(4)+T(5),T(14),T(14)+T(15)
2300 WINDOW T(6),T(6)+T(7),T(16),T(16)+T(17)
2310 AXIS T(8),T(18)
2320 U1=1
2330 R2=T(18)/(T(17)/T(15))
2340 R3=T(14)
2350 U$=STR(T(16)+(U1-1)*T(18))
2360 PRINT @32,21:T(4)-(LEN(U$)+1)*1.78,R3-0.89
2370 PRINT U$;
2380 IF U1>T(19) THEN 2420
2390 R3=R3+R2
2400 U1=U1+1
2410 GO TO 2350
2420 R2=T(8)/(T(7)/T(5))
2430 U$=STR(T(7))
2440 IF (LEN(U$)+1)*1.78<R2 THEN 2490
2450 T(8)=T(8)+T(8)
2460 R2=R2+R2
2470 T(9)=T(9)/2
2480 GO TO 2440
2490 R3=T(4)
2500 U1=1
2510 U$=STR(T(6)+(U1-1)*T(8))
2520 U0=(LEN(U$)+1)*1.78
2530 PRINT @32,21:R3-U0*0.5,T(14)-4
2540 PRINT U$;
2550 IF U1>T(9) THEN 2590
2560 R3=R3+R2
2570 U1=U1+1
2580 GO TO 2510
2590 FOR U1=1 TO T(1)
2600 IF T(2)<>1 THEN 2620
2610 IF U1>1 THEN 2640
2620 MOVE X(1)+(U1-1)*X(2),Y(U1)
2630 GO TO 2650
2640 DRAW X(1)+(U1-1)*X(2),Y(U1)
2650 GOSUB 2690
2660 NEXT U1
2670 HOME 
2680 GO TO 320
2690 S2=T(14+3)/T(14+1)*0.75
2700 S1=T(4+3)/T(4+1)*0.75
2710 GO TO T(3) OF 3000,2730,2790,2860,2930
2720 GO TO 3000
2730 RMOVE 0,S2
2740 RDRAW S1,-2*S2
2750 RDRAW -2*S1,0
2760 RDRAW S1,2*S2
2770 RMOVE 0,-S2
2780 RETURN 
2790 RDRAW 0,S2
2800 RDRAW 0,-2*S2
2810 RDRAW 0,S2
2820 RDRAW -S1,0
2830 RDRAW 2*S1,0
2840 RDRAW -S1,0
2850 RETURN 
2860 RMOVE S1,S2
2870 RDRAW 0,-2*S2
2880 RDRAW -2*S1,0
2890 RDRAW 0,2*S2
2900 RDRAW 2*S1,0
2910 RMOVE -S1,-S2
2920 RETURN 
2930 RMOVE 0,S2
2940 RDRAW S1,-S2
2950 RDRAW -S1,-S2
2960 RDRAW -S1,S2
2970 RDRAW S1,S2
2980 RMOVE 0,-S2
2990 RETURN 
3000 IF T(2)=1 THEN 3020
3010 RDRAW 0,0
3020 RETURN 
3030 T(22)=10^39
3040 T(23)=-T(22)
3050 FOR U1=1 TO T(1)
3060 T(22)=T(22) MIN Y(U1)
3070 T(23)=T(23) MAX Y(U1)
3080 NEXT U1
3090 T(16)=T(22)
3100 T9=T(23)-T(22)
3105 T(17)=T9*(T9<>0)+(T9=0)
3110 RETURN 
3120 DIM S0(5)
3130 S0(3)=INT(T(U9+1)/15)
3140 S0(3)=T(U9+3)/S0(3)
3150 S0(4)=INT(ABS(LGT(S0(3))))*SGN(LGT(S0(3)))
3160 S0(4)=INT(10^S0(4)+1.0E-4)
3170 IF S0(4)>0 THEN 3210
3180 S0(3)=1
3190 S0(4)=1
3200 GO TO 3290
3210 S0(5)=S0(3)/S0(4)
3220 S0(3)=S0(4)*10
3230 IF S0(5)=>10 THEN 3250
3240 S0(3)=S0(4)*5
3250 IF S0(5)=>5 THEN 3270
3260 S0(3)=S0(4)*2
3270 IF S0(5)=>2 THEN 3290
3280 S0(3)=S0(4)
3290 S0(5)=T(U9+2)/S0(3)
3300 IF S0(5)=>0 THEN 3320
3310 S0(5)=S0(5)-0.9999
3320 S0(1)=S0(3)*(INT(ABS(S0(5)))*SGN(S0(5)))
3330 S0(5)=(T(U9+3)+T(U9+2))/S0(3)
3340 IF S0(5)<0 THEN 3360
3350 S0(5)=S0(5)+0.9999
3360 S0(2)=S0(3)*(INT(ABS(S0(5)))*SGN(S0(5)))
3370 S0(5)=S0(2)-S0(1)
3380 S0(4)=INT(INT(ABS(S0(5)))*SGN(S0(5))/S0(3))
3390 IF S0(5)>0 THEN 3420
3400 S0(3)=S0(5)
3410 S0(4)=1
3420 IF S0(3)>0 THEN 3450
3430 S0(3)=S0(5)
3440 S0(4)=1
3450 T(U9+2)=S0(1)
3460 T(U9+3)=S0(2)-S0(1)
3470 T(U9+4)=S0(3)
3480 T(U9+5)=S0(4)
3490 T(U9+6)=1.75*T(U9+3)/T(U9+1)
3500 RETURN

